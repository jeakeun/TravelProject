<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>3ì›” 6ì¼ ì§€êµ¬ ì¢…ë§</title>
    
    <style>
        #map { width: 100%; height: 600px; } /* ì§€ë„ê°€ ë³´ì´ê¸° ìœ„í•œ í•„ìˆ˜ ë†’ì´ */
        .search-box { margin-bottom: 10px; padding: 10px; background: #f8f9fa; }
        
     .category-container { position: absolute; top: 10px; right: 10px; z-index: 10; display: flex; gap: 5px; }
   	 .category-btn { padding: 8px 12px; background: #fff; border: 1px solid #ccc; border-radius: 20px; cursor: pointer; font-size: 13px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
     .category-btn:hover { background: #f0f0f0; }
     .category-btn.active { background: #fee500; border-color: #f7e600; font-weight: bold; }
    </style>
</head>
<body>

<div class="category-container">
    <button class="category-btn" onclick="searchByCategory('AT4', this)">ğŸ–ï¸ ì—¬í–‰ì§€</button>
    <button class="category-btn" onclick="searchByCategory('FD6', this)">ğŸ´ ìŒì‹ì </button>
    <button class="category-btn" onclick="searchByCategory('AD5', this)">ğŸ¨ ìˆ™ë°•ì‹œì„¤</button>
</div>

<div class="search-box">
    <input type="text" id="keyword" placeholder="ì¥ì†Œ ì…ë ¥ (ì˜ˆ: ë¶€ì‚°ì—­)" onkeypress="if(event.keyCode==13) searchPlaces()">
    <button onclick="searchPlaces()">ê²€ìƒ‰</button>
</div>
<div id="map"></div>

<script type="text/javascript"  src="//dapi.kakao.com/v2/maps/sdk.js?appkey=0fe7c7a264f9456db151ae55939175a2&libraries=services"></script>

<script>
var mapContainer = document.getElementById('map'), 
    mapOption = { center: new kakao.maps.LatLng(37.56682, 126.97865), level: 3 };  

var map = new kakao.maps.Map(mapContainer, mapOption); 
var ps = new kakao.maps.services.Places(); 
var infowindow = new kakao.maps.InfoWindow({zIndex:1});
var markers = [];

function searchPlaces() {
    var keyword = document.getElementById('keyword').value;
    if (!keyword.trim()) { alert('ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”!'); return; }
    ps.keywordSearch(keyword, placesSearchCB); 
}

function placesSearchCB(data, status) {
    if (status === kakao.maps.services.Status.OK) {
        removeMarkers();
        var bounds = new kakao.maps.LatLngBounds();
        for (var i=0; i<data.length; i++) {
            displayMarker(data[i]);    
            bounds.extend(new kakao.maps.LatLng(data[i].y, data[i].x));
        }       
        map.setBounds(bounds);
    } else {
        alert('ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.');
    }
}

// [í•µì‹¬] ë§ˆì»¤ ìƒì„± ë° í´ë¦­ ì´ë²¤íŠ¸ ì—°ê²° í•¨ìˆ˜
function displayMarker(place) {
    var marker = new kakao.maps.Marker({
        map: map,
        position: new kakao.maps.LatLng(place.y, place.x) 
    });
    markers.push(marker);

    // ë§ˆì»¤ í´ë¦­ ì‹œ ì¸í¬ìœˆë„ìš°ë¥¼ ë„ìš°ëŠ” ì´ë²¤íŠ¸ë¥¼ ë“±ë¡í•©ë‹ˆë‹¤
    kakao.maps.event.addListener(marker, 'click', function() {
        // ìƒì„¸ ì •ë³´ì°½ ë‚´ìš© êµ¬ì„± (ê°€ì¥ ì•ˆì „í•œ ë¬¸ìì—´ ê²°í•© ë°©ì‹)
        var content = '<div style="padding:10px; min-width:200px; line-height:1.5;">' +
                      '    <strong style="color:#2db400;">' + place.place_name + '</strong><br>' +
                      '    <span style="font-size:12px; color:#666;">' + (place.road_address_name || place.address_name) + '</span><br>' +
                      '    <span style="font-size:12px; color:#09f;">' + (place.phone || "ì „í™”ë²ˆí˜¸ ì—†ìŒ") + '</span><br>' +
                      '    <hr style="margin:5px 0; border:0; border-top:1px solid #eee;">' +
                      '    <a href="' + place.place_url + '" target="_blank" style="font-size:12px; color:blue; text-decoration:none;">ìƒì„¸ë³´ê¸° ></a>' +
                      '</div>';

        infowindow.setContent(content);
        infowindow.open(map, marker);
    });
}

function removeMarkers() {
    for (var i = 0; i < markers.length; i++) { markers[i].setMap(null); }
    markers = [];
}

function searchByCategory(categoryCode, element) {
    // 1. ë²„íŠ¼ í™œì„±í™” ìƒíƒœ í‘œì‹œ (UI í”¼ë“œë°±)
    var btns = document.querySelectorAll('.category-btn');
    btns.forEach(function(btn) { btn.style.background = '#fff'; });
    element.style.background = '#fee500';

    // 2. í˜„ì¬ ì§€ë„ ì¤‘ì‹¬ê³¼ ë²”ìœ„ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì¹´í…Œê³ ë¦¬ ê²€ìƒ‰ ìˆ˜í–‰
    // { useMapBounds: true } ì˜µì…˜ì´ í˜„ì¬ í™”ë©´ ì•ˆì˜ ì¥ì†Œë§Œ ì°¾ì•„ì¤ë‹ˆë‹¤.
    ps.categorySearch(categoryCode, function(data, status) {
        if (status === kakao.maps.services.Status.OK) {
            // ê¸°ì¡´ ë§ˆì»¤ë“¤ì„ ëª¨ë‘ ì§€ì›ë‹ˆë‹¤
            removeMarkers(); 

            for (var i = 0; i < data.length; i++) {
                displayMarker(data[i]);
                // ğŸ’¡ [ì¤‘ìš”] map.setBounds(bounds) ì½”ë“œë¥¼ ì‚­ì œí–ˆìŠµë‹ˆë‹¤.
                // ì´ ì½”ë“œê°€ ì—†ì–´ì•¼ í˜„ì¬ ë³´ê³  ìˆëŠ” ì§€ë„ì˜ ìœ„ì¹˜ì™€ í™•ëŒ€ ìˆ˜ì¤€ì´ ìœ ì§€ë©ë‹ˆë‹¤.
            }
        } else if (status === kakao.maps.services.Status.ZERO_RESULT) {
            alert('í˜„ì¬ í™”ë©´ ë²”ìœ„ ë‚´ì— í•´ë‹¹ ì¥ì†Œê°€ ì—†ìŠµë‹ˆë‹¤.');
        }
    }, { useMapBounds: true }); 
}
</script>
</body>
</html>